'use strict';

var Promise = require('promise'),
	config = require('mj-config'),
	jwt    = require('jsonwebtoken');

/**
 * generate JWT token
 * @params json: jsonData
 * @returns
*/
exports.generateToken = function(jsonData) {
    return new Promise(function (resolve,reject) {
		var token = jwt.sign(jsonData, config.password, {expiresIn: 60*60*24});
		return resolve(token);
    });
}

/**
 * verify JWT token
 * @params string: token
 * @returns
*/
exports.verifyToken = function(token) {
    return new Promise(function (resolve,reject) {
		jwt.verify(token, config.password, function(err, decoded) {      
			if (err) {
				return reject('E516');
			} 
			return resolve();
		});
    });
}
